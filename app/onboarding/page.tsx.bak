"use client";

import { useEffect, useState } from "react";
import { useRouter } from "next/navigation";
import { loadProfile, saveProfile, type UserProfile } from "@/lib/profile";

export default function OnboardingPage() {
  const router = useRouter();

  const [name, setName] = useState("");
  const [lookingFor, setLookingFor] =
    useState<UserProfile["lookingFor"]>("open");
  const [pace, setPace] = useState<UserProfile["pace"]>("balanced");

  useEffect(() => {
    const existing = loadProfile();
    if (existing) {
      setName(existing.name || "");
      setLookingFor(existing.lookingFor || "open");
      setPace(existing.pace || "balanced");
    }
  }, []);

  function handleContinue() {
    const profile: UserProfile = {
      name: name.trim(),
      lookingFor,
      pace,
    };

    saveProfile(profile);
    router.push("/onboarding/profile");
  }

  const canContinue = name.trim().length > 0;

  return (
    <div className="min-h-screen bg-gradient-to-b from-slate-950 via-slate-900 to-slate-950 text-white">
      <div className="mx-auto max-w-xl px-4 pb-10 pt-10">
        <div className="mb-8 space-y-2">
          <p className="text-xs uppercase tracking-[0.2em] text-white/50">
            Lumi onboarding
          </p>
          <h1 className="text-2xl font-semibold tracking-tight">
            Let’s start with the basics.
          </h1>
          <p className="text-sm text-white/60">
            Rivva uses geolocation in the background, so you don’t have to type
            your location.
          </p>
        </div>

        <div className="space-y-6">
          <div className="space-y-2">
            <label className="text-sm font-medium text-white/80">Name</label>
            <input
              value={name}
              onChange={(e) => setName(e.target.value)}
              placeholder="What should Lumi call you?"
              className="w-full rounded-xl bg-white/5 px-3 py-2 text-sm outline-none ring-1 ring-white/10 focus:ring-emerald-400"
            />
          </div>

          <div className="space-y-2">
            <label className="text-sm font-medium text-white/80">
              What are you looking for?
            </label>
            <select
              value={lookingFor}
              onChange={(e) =>
                setLookingFor(e.target.value as UserProfile["lookingFor"])
              }
              className="w-full rounded-xl bg-white/5 px-3 py-2 text-sm outline-none ring-1 ring-white/10 focus:ring-emerald-400"
            >
              <option value="serious">Serious relationship</option>
              <option value="open">Open to connection</option>
              <option value="casual">Casual / low pressure</option>
            </select>
          </div>

          <div className="space-y-2">
            <label className="text-sm font-medium text-white/80">
              What’s your pacing style?
            </label>
            <select
              value={pace}
              onChange={(e) => setPace(e.target.value as UserProfile["pace"])}
              className="w-full rounded-xl bg-white/5 px-3 py-2 text-sm outline-none ring-1 ring-white/10 focus:ring-emerald-400"
            >
              <option value="slow">Slow + intentional</option>
              <option value="balanced">Balanced</option>
              <option value="fast">Fast mover</option>
            </select>
          </div>

          <button
            onClick={handleContinue}
            disabled={!canContinue}
            className="w-full rounded-full bg-emerald-500 px-4 py-2.5 text-sm font-semibold text-emerald-950 hover:bg-emerald-400 disabled:cursor-not-allowed disabled:bg-emerald-500/40"
          >
            Continue
          </button>
        </div>
      </div>
    </div>
  );
}
